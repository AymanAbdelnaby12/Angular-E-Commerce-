
<div class="container py-5 cart-page">
  <h2 class="text-center mb-5 text-success fw-bold">Cart Products</h2>

   @if (cartList.length > 0 && !loading) {
    <div class="mb-3">
      <button class="btn btn-danger" (click)="clearCart()">Clear Cart</button>
    </div>
  }

  <!-- Loading state -->
  @if (loading) {
    <div class="text-center">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p>Loading product details...</p>
    </div>
  }

  <!-- Cart Items -->
  @if (!loading && cartList.length > 0) {
    <div class="row g-4">
      <!-- Left side - Cart items -->
      <div class="col-lg-8">
        @for (item of cartList; track item.product._id) {
          <div class="cart-item shadow-sm p-3 rounded mb-3">
            <div class="row align-items-center">
              <!-- Product image -->
              <div class="col-md-2">
                <img [src]="item.product.imageCover" class="img-fluid rounded" alt="Product">
              </div>

              <!-- Product name -->
              <div class="col-md-4">
                <h6 class="mb-0">{{ item.product.title }}</h6>
              </div>

              <!-- Quantity control -->
              <div class="col-md-2 d-flex align-items-center qty-control">
                <button class="btn btn-outline-secondary btn-sm" (click)="updateCart(item.product._id, item.count - 1)">âˆ’</button>
                <input type="number" [(ngModel)]="item.count" min="1" class="form-control mx-1 text-center">
                <button class="btn btn-outline-secondary btn-sm" (click)="updateCart(item.product._id, item.count + 1)">+</button>
              </div>

              <!-- Price -->
              <div class="col-md-2 text-success fw-bold">
                {{ item.price | currency:'USD' }}
              </div>

              <!-- Remove -->
              <div class="col-md-2">
                <button class="btn btn-link text-danger p-0" (click)="removeItem(item.product._id)">Remove</button>
              </div>
            </div>
          </div>
        }
      </div>

      <!-- Right side - Summary -->
      <div class="col-lg-4">
        <div class="card p-3 shadow-sm">
          <h5 class="fw-bold mb-3">Order Summary</h5>
          <div class="d-flex justify-content-between mb-2">
            <span>Total Price:</span>
            <span class="fw-bold text-success">{{ totalPrice | currency:'USD' }}</span>
          </div>
          <button class="btn btn-success w-100 mt-3" [routerLink]="['/checkout',cartId]">Proceed to Checkout</button>
        </div>
      </div>
    </div>
  }

  <!-- Empty Cart -->
  @if (!loading && cartList.length === 0) {
    <div class="text-center py-5">
        <div class="text-center p-5"> 
      <h4>Your cart is empty!</h4>
      <a [routerLink]="'/products'" class="btn btn-primary mt-3">Go Shopping</a>
    </div>
    </div>
  } 
</div>
